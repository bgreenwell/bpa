# bpa: Basic Pattern Analysis in R

[![Build Status](https://travis-ci.org/bgreenwell/bpa.svg?branch=master)](https://travis-ci.org/bgreenwell/bpa)
[![Coverage Status](https://img.shields.io/codecov/c/github/bgreenwell/bpa.svg)](https://codecov.io/github/bgreenwell/bpa?branch=master)

Package `bpa`, through the function `basic_pattern_analysis`, allows the analyst to easily identify weird or unexpected data points. For example, multiple date formats or other typos.

## Installation
Package `bpa` is not currently available from CRAN, but the development version is hosted on GitHub at https://github.com/bgreenwell/bpa and can be installed using [`devtools`](https://github.com/hadley/devtools):
```r
# Assuming devtools is already installed
devtools::install_github("bgreenwell/bpa")
```
Bug reports should be submitted to https://github.com/bgreenwell/bpa/issues.

## Basic usage

The most basic function is `get_pattern`, which is not exported so one must use `bpa:::get_pattern`. This function is used internally to extract patterns from a vector of data. For example, consider a vector of dates:
```{r}
dates <- seq(as.Date("1910/1/1"), as.Date("1915/1/1"), "years")
print(dates)

## [1] "1910-01-01" "1911-01-01" "1912-01-01" "1913-01-01" "1914-01-01"
## [6] "1915-01-01"
```
We can easily extract the unique patterns:
```{r}
patterns <- bpa:::get_pattern(dates)
unique(patterns)  # only display the unique patterns

## [1] "9999-99-99"
```
All dates appear to have the same format. However, suppose the dates are entered in multiple formats (perhaps the data arose from the merger of two data bases, each using a different date format):
```{r}
dates[3] <- "01/01/1912"  # change the third date format
dates[5] <- "01/01/1914"  # change the fifth date format
print(dates)

## [1] "1910-01-01" "1911-01-01" "1-01-19"    "1913-01-01" "1-01-19"   
## [6] "1915-01-01"
```
We can easily detect such problems:
```{r}
patterns <- bpa:::get_pattern(dates)
unique(patterns)  # only display the unique patterns

## [1] "9999-99-99" "9-99-99"
```
Notice that all the digits are represented by the character `9`. Similarly, all lowercase/uppercase letters are represented by the character `a`/`A`. Everything else (e.g. -, @, #, etc.)
 remain the same. The only exception is whitespace characters which are represented as `w` if `show_whitespace = TRUE`.
 
The function `basic_pattern_analysis` applies this function to each column of a data frame and, by default, returns a `"dataframe"` object. This function is especially useful when working with voluminous, messy, and unfamiliar data sets. The following code exemplifies this.
```{r}
# Load package
library(bpa)

# Look at patterns of first six observations (returns a data frame by default)
iris %>%
  head %>%
  basic_pattern_analysis  # you can also use bpa for short

##   Sepal.Length Sepal.Width Petal.Length Petal.Width Species
## 1          9.9         9.9          9.9         9.9  aaaaaa
## 2          9.9           9          9.9         9.9  aaaaaa
## 3          9.9         9.9          9.9         9.9  aaaaaa
## 4          9.9         9.9          9.9         9.9  aaaaaa
## 5            9         9.9          9.9         9.9  aaaaaa
## 6          9.9         9.9          9.9         9.9  aaaaaa

# All unique patterns (returns a list) -- bpa is an alias for basic_pattern_analysis
bpa(iris, unique_only = TRUE)

## $Sepal.Length
## 
##   9 9.9 
##  17 133 
## 
## $Sepal.Width
## 
##   9 9.9 
##  28 122 
## 
## $Petal.Length
## 
##   9 9.9 
##  13 137 
## 
## $Petal.Width
## 
##   9 9.9 
##  13 137 
## 
## $Species
## 
##     aaaaaa  aaaaaaaaa aaaaaaaaaa 
##         50         50         50
```
