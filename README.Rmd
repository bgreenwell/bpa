# bpa: Basic Pattern Analysis in R

[![Build Status](https://travis-ci.org/bgreenwell/bpa.svg?branch=master)](https://travis-ci.org/bgreenwell/bpa)
[![Coverage Status](https://img.shields.io/codecov/c/github/bgreenwell/bpa.svg)](https://codecov.io/github/bgreenwell/bpa?branch=master)

Package `bpa`, through the function `basic_pattern_analysis`, allows the analyst to easily identify weird or unexpected data points. For example, multiple date formats or other typos.

## Installation
Package `bpa` is not currently available from CRAN, but the development version is hosted on GitHub at https://github.com/bgreenwell/bpa and can be installed using [`devtools`](https://github.com/hadley/devtools):
```r
# Assuming devtools is already installed
devtools::install_github("bgreenwell/bpa")
```
Bug reports should be submitted to https://github.com/bgreenwell/bpa/issues.

## Basic usage

For illustration, this package comes with a simulated data set containing 1000 observations on three variables:

  1. `Gender` - Gender of subject.
  2. `Date` - Date of observation.
  3. `Phone` - Subject's phone number.

```{r}
# Load the package
library(bpa)

# Load the data
data(messy, package = "bpa")
head(messy)
```

The most basic function is `get_pattern`. This function is used internally to extract patterns from a vector of data. For example, consider `Date` column. We can easily extract the unique patterns:
```{r}
patterns <- get_pattern(messy$Date)
patterns %>% table %>% as.data.frame  # frequency of each pattern
```
It appears as though the `Date` column contains four different date formats -- which is a problem since `R` requires dates to have a standard unambiguous format. Perhaps the data were entered in by different people, or the data are the result of a merge from multiple sources? Nonetheless, now that we have identified a problem, we can easily correct it by converting to a single standard date format.

Notice that all the digits are represented by the character `9`. Similarly, all lowercase/uppercase letters are represented by the character `a`/`A`. Everything else (e.g. -, @, #, etc.) remains the same. The only exception are whitespace characters which are represented as `w` (by default) if `show_ws = TRUE`. This can be changed to any character string using the `ws_char` option. For example,
```{r}
get_pattern("(123)  456-789")
get_pattern("(123)  456-789", show_ws = FALSE)  # same as ws_char = " "
get_pattern("(123)  456-789", ws_char = "<ws>")
```
 
The function `basic_pattern_analysis` applies `get_pattern` to each column of a data frame and, by default, returns a `"dataframe"` object. This function is especially useful when working with big, messy, and unfamiliar data sets. The following code exemplifies this by highlighting potential issues in the entire data set (e.g., some phone numbers contain parentheses around the area code while other do not).
```{r}
# Look at patterns of first six observations (returns a data frame by default)
messy %>%
  slice(1:10) %>%         # first 10 observations
  basic_pattern_analysis  # you can also use bpa for short

# All unique patterns (returns a list) -- bpa is an alias for basic_pattern_analysis
bpa(messy, unique_only = TRUE)

# Extract Gender values matching the pattern "Aaaa"
# match_pattern(messy$Gender, pattern = "Aaaa", unique_only = TRUE)
```
